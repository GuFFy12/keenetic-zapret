# Keenetic Zapret

## Замечания

- Этот код создан для изучения сетевых технологий. Он может быть полезен для улучшения работы интернета, но то, как вы его используете — ваш выбор.
  Автор ответственности не несет.

- Конфигурация Zapret протестирована и работает стабильно. Со временем настройки могут стать неактуальными,
  проверяйте актуальные методы в репозитории и обсуждениях [Zapret](https://github.com/bol-van/zapret).

- Настройка `--dpi-desync-fooling=badsum` в Zapret может работать некорректно если роутер Keenetic находится за другим nat.
  Например таким устройством может быть оптический терминал который стоит до роутера.
  В этом случае данное устройство нужно перевести в режим моста (bridge).

## Требования

- [Keenetic OS](https://help.keenetic.com/hc/ru/articles/115000990005).
- Установленный [Entware](https://help.keenetic.com/hc/ru/articles/360021214160).

## Шаги установки

### 1. Настройки в веб-панели Keenetic

- В [компонентах KeeneticOS](https://help.keenetic.com/hc/ru/articles/360000358039) нужно включить `Kernel modules for Netfilter` или `Модули ядра подсистемы Netfilter`.

- Опционально отключите [DNS от провайдера](https://help.keenetic.com/hc/ru/articles/360008609399) и настройте [DNS-over-HTTPS](https://help.keenetic.com/hc/ru/articles/360007687159), например от CloudFlare: `https://cloudflare-dns.com/dns-query`. После его установки начинают работать некоторые сервисы, которые заблокированы по IP, например Instagram (запрещен в России, принадлежит Meta).

### 2. Установка

- Скачайте [файл релиза](https://github.com/GuFFy12/keenetic-zapret/releases) формата `.ipk` прямо на роутере. Также можно скачать файл локально и переместить его через [Менеджер USB-устройств](https://help.keenetic.com/hc/en-us/articles/360000799559).

- Установите пакет командой: `opkg install <ИМЯ_ФАЙЛА>`.

- Дальнейшие настройки осуществляются редактированием `/opt/zapret/config` файла и добавлением списков в файлы `/opt/zapret/ipset/*`.
